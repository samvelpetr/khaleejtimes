;
(self.AMP=self.AMP||[]).push({m:0,v:"2311171837000",n:"amp-experiment",ev:"0.1",l:!0,f:function(n,t){!function(){function t(n,r){return(t=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,r)}function r(n){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function i(n,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}Array.isArray;var u=Object.prototype,o=u.hasOwnProperty,c=u.toString;function f(n,t){return o.call(n,t)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var a,l=self.__AMP_LOG;function s(n){return function(n,t){throw new Error("failed to call initLogConstructor")}()}function v(n,t,r,e,i,u,o,c,f,a,l){return n}function p(n,t,r,e,i,u,o,c,f,a,v){return(l.user||(l.user=s()),void l.user.win?l.userForEmbed||(l.userForEmbed=s()):l.user).assert(n,t,r,e,i,u,o,c,f,a,v)}var h=function(){var n=this;this.promise=new Promise((function(t,r){n.resolve=t,n.reject=r}))};function m(n,t){return w(n=function(n){return n.__AMP_TOP||(n.__AMP_TOP=n)}(n),t)}function b(n,t){return function(n,t){var r=O(n,t);if(r)return r;var e,i,u,o,c=g(n);return c[t]=(i=(e=new h).promise,u=e.reject,o=e.resolve,i.catch((function(){})),{obj:null,promise:i,resolve:o,reject:u,context:null,ctor:null}),c[t].promise}(j(n),t)}function d(n,t){return O(j(n),t)}function y(n){return n.nodeType?(r=n,t=(r.ownerDocument||r).defaultView,m(t,"ampdoc")).getAmpDoc(n):n;var t,r}function j(n){var t=y(n);return t.isSingleDoc()?t.win:t}function w(n,t){v(function(n,t){var r=n.__AMP_SERVICES&&n.__AMP_SERVICES[t];return!(!r||!r.ctor)}(n,t));var r=g(n)[t];return r.obj||(v(r.ctor),v(r.context),r.obj=new r.ctor(r.context),v(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function O(n,t){var r=g(n)[t];return r?r.promise?r.promise:(w(n,t),r.promise=Promise.resolve(r.obj)):null}function g(n){var t=n.__AMP_SERVICES;return t||(t=n.__AMP_SERVICES={}),t}var x=/^[\w-]+$/,P=function(){function n(n){this.ampdoc=n,this.lJ=new h}var t=n.prototype;return t.init=function(n){this.lJ.resolve(n)},t.getVariants=function(){return this.lJ.promise},t.whenReady=function(){return this.getVariants()},n}();function S(n,t,r){R(t),function(n){var t,r=n.variants;p((t=r,"[object Object]"===c.call(t)&&Object.keys(r).length>0),"Missing experiment variants config."),n.group&&R(n.group);var e=0;for(var i in r)if(f(r,i)){R(i);var u=r[i];p("number"==typeof u&&u>0&&u<100,"Invalid percentage %s:%s. Has to be greater than 0 and less than 100",i,u),e+=u}p(e.toFixed(6)<=100,"Total percentage is bigger than 100: "+e)}(r);var e=n.getParam("amp-x-"+t);if(e&&f(r.variants,e))return Promise.resolve(e);var i,u=!1!==r.sticky,o=r.cidScope||"amp-experiment",l=Promise.resolve(!0);return u&&r.consentNotificationId&&(l=(i=n.getHeadNode(),function(n,t,r,e){return function(n,t,r,e){var i=d(n,t);if(i)return i;var u=y(n);return u.whenExtensionsKnown().then((function(){var n=u.getExtensionVersion(r);return n?m(u.win,"extensions").waitForExtension(r,n):null})).then((function(r){return r?e?d(n,t):b(n,t):null}))}(n,t,r,e).then((function(n){return function(n,t,r){return p(n,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",t,r,r,r)}(n,t,r)}))}(i,"userNotificationManager","amp-user-notification")).then((function(n){return n.getNotification(r.consentNotificationId)})).then((function(n){return p(n,"Notification not found: ".concat(r.consentNotificationId)),n.isDismissed()}))),l.then((function(e){if(!e)return null;var i=r.group||t;return function(n,t,r){if(!r)return Promise.resolve(100*n.win.Math.random());var e,i,u=(e=n,b(e,"cid")).then((function(n){return n.get({scope:r,createCookieIfNotPresent:!0},a||(a=Promise.resolve(void 0)))}));return Promise.all([u,(i=n.win,m(i,"crypto"))]).then((function(n){return n[1].uniform(t+":"+n[0])})).then((function(n){return 100*n}))}(n,i,u?o:null).then((function(n){for(var t=0,e=Object.keys(r.variants).sort(),i=0;i<e.length;i++)if(n<(t+=r.variants[e[i]]))return e[i];return null}))}))}function R(n){p(x.test(n),"Invalid name: %s. Allowed chars are [a-zA-Z0-9-_].",n)}var I=function(n){!function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),r&&t(n,r)}(c,n);var e,u,o=(e=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}(),function(){var n,t=r(e);if(u){var o=r(this).constructor;n=Reflect.construct(t,arguments,o)}else n=t.apply(this,arguments);return i(this,n)});function c(){return o.apply(this,arguments)}c.prerenderAllowed=function(){return!0};var f=c.prototype;return f.isLayoutSupported=function(n){return"nodisplay"==n||"container"==n},f.isBuildRenderBlocking=function(){return!0},f.buildCallback=function(){var n=this;return b(this.getAmpDoc(),"variant").then((function(t){try{var r=n.TS(),e=Object.create(null),i=Object.keys(r).map((function(t){return S(n.getAmpDoc(),t,r[t]).then((function(n){e[t]=n}))})),u=Promise.all(i).then((function(){return e})).then(n.pJ.bind(n));t.init(u)}catch(n){throw t.init({}),n}}))},f.TS=function(){var n,t=this.element.children;return p(1==t.length&&"SCRIPT"==t[0].tagName&&"APPLICATION/JSON"==t[0].getAttribute("type").toUpperCase(),'<amp-experiment> should contain exactly one <script type="application/json"> child.'),v((n=t[0].textContent,JSON.parse(n)))},f.pJ=function(n){return this.getAmpDoc().waitForBodyOpen().then((function(t){for(var r in n)n[r]&&t.setAttribute("amp-x-"+r,n[r]);return n}))},c}(n.BaseElement);n.registerServiceForDoc("variant",P),n.registerElement("amp-experiment",I)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-experiment-0.1.js.map